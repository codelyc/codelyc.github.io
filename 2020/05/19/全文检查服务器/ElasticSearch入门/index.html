<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Elasticsearch入门篇 | 林雨的小世界</title><meta name="description" content="介绍ElasticSearch的作用，搭建elasticsearch的环境（Windows&#x2F;Linux），对分词器的安装及使用；对es集群的搭建（Windows）下。本章介绍的ElasticSearch操作基于Restful形式，java代码操作请参考下篇：XXX 1.ElasticSearch简介 Elaticsearch，简称为es， es是一个开源的高扩展的分布式全文检索引擎，它可以近乎实时"><meta name="keywords" content="java,全文检索服务器"><meta name="author" content="小雨"><meta name="copyright" content="小雨"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon2.png"><link rel="canonical" href="http://www.codelyc.top/2020/05/19/%E5%85%A8%E6%96%87%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/ElasticSearch%E5%85%A5%E9%97%A8/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//ta.qq.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="msvalidate.01" content="9ebe1e5ede8f47f593394e71e067ea1c"/><meta name="baidu-site-verification" content="rPXKeoppXyKHFD9V"/><meta property="og:type" content="article"><meta property="og:title" content="Elasticsearch入门篇"><meta property="og:url" content="http://www.codelyc.top/2020/05/19/%E5%85%A8%E6%96%87%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/ElasticSearch%E5%85%A5%E9%97%A8/"><meta property="og:site_name" content="林雨的小世界"><meta property="og:description" content="介绍ElasticSearch的作用，搭建elasticsearch的环境（Windows&#x2F;Linux），对分词器的安装及使用；对es集群的搭建（Windows）下。本章介绍的ElasticSearch操作基于Restful形式，java代码操作请参考下篇：XXX 1.ElasticSearch简介 Elaticsearch，简称为es， es是一个开源的高扩展的分布式全文检索引擎，它可以近乎实时"><meta property="og:image" content="http://www.codelyc.top/img/meinv1.png"><meta property="article:published_time" content="2020-05-18T16:00:00.000Z"><meta property="article:modified_time" content="2020-08-13T04:16:43.513Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="prev" title="CentOS7系统安装" href="http://www.codelyc.top/2020/07/07/linux%E5%B7%A5%E5%85%B7/linux%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?e449a26b19577ea509e13eee8811560e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-170043700-1', 'auto');
ga('send', 'pageview');
</script><script src="https://tajs.qq.com/stats?sId=02BF70EFC49B8B5CDC46FA06FCEF06AC" charset="UTF-8"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: undefined,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">28</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">43</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-ElasticSearch简介"><span class="toc-number">1.</span> <span class="toc-text">1.ElasticSearch简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1ElasticSearch的使用案例"><span class="toc-number">1.1.</span> <span class="toc-text">1.1ElasticSearch的使用案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-2-ElasticSearch与solr的对比"><span class="toc-number">2.</span> <span class="toc-text">1.2 ElasticSearch与solr的对比</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-安装"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2修改配置文件"><span class="toc-number">2.2.</span> <span class="toc-text">2.2修改配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-启动"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-安装图形化插件"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 安装图形化插件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-ES相关概念"><span class="toc-number">3.</span> <span class="toc-text">3.ES相关概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-概述（重要）"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 概述（重要）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-核心概念"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）index索引"><span class="toc-number">3.2.0.1.</span> <span class="toc-text">1）index索引-</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）type类型"><span class="toc-number">3.2.0.2.</span> <span class="toc-text">2）type类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Filed字段"><span class="toc-number">3.2.0.3.</span> <span class="toc-text">3)Filed字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4）映射mapping"><span class="toc-number">3.2.0.4.</span> <span class="toc-text">4）映射mapping</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5）document文档"><span class="toc-number">3.2.0.5.</span> <span class="toc-text">5）document文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6）集群cluster"><span class="toc-number">3.2.0.6.</span> <span class="toc-text">6）集群cluster</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7）节点node"><span class="toc-number">3.2.0.7.</span> <span class="toc-text">7）节点node</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8）分片和复制-shards-amp-replicas"><span class="toc-number">3.2.0.8.</span> <span class="toc-text">8）分片和复制 shards&amp;replicas</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-ElasticSearch客户端操作"><span class="toc-number">4.</span> <span class="toc-text">4.ElasticSearch客户端操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1使用Restful接口直接访问"><span class="toc-number">4.1.</span> <span class="toc-text">4.1使用Restful接口直接访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2使用Talend-API-tester进行es客户端操作。"><span class="toc-number">4.2.</span> <span class="toc-text">4.2使用Talend API tester进行es客户端操作。</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）Elasticsearch的接口语法"><span class="toc-number">4.2.0.1.</span> <span class="toc-text">1）Elasticsearch的接口语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）创建索引库index并添加映射mapping——PUT"><span class="toc-number">4.2.0.2.</span> <span class="toc-text">2）创建索引库index并添加映射mapping——PUT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）先创建索引index，再添加mapping-—-PUT"><span class="toc-number">4.2.0.3.</span> <span class="toc-text">3）先创建索引index，再添加mapping —-PUT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-删除索引index-—-DELETE"><span class="toc-number">4.2.0.4.</span> <span class="toc-text">4)删除索引index —-DELETE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-创建文档document（向索引库中添加内容）—POST"><span class="toc-number">4.2.0.5.</span> <span class="toc-text">5)创建文档document（向索引库中添加内容）—POST</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6）修改document内容—-POST"><span class="toc-number">4.2.0.6.</span> <span class="toc-text">6）修改document内容—-POST</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-删除文档document—DELETE"><span class="toc-number">4.2.0.7.</span> <span class="toc-text">7)删除文档document—DELETE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-查询文档document—–GET"><span class="toc-number">4.2.0.8.</span> <span class="toc-text">8)查询文档document—–GET</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#i-根据id查询"><span class="toc-number">4.2.0.8.1.</span> <span class="toc-text">i.根据id查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ii-根据关键字查询-term查询"><span class="toc-number">4.2.0.8.2.</span> <span class="toc-text">ii.根据关键字查询-term查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#iii-查询文档-querystring查询"><span class="toc-number">4.2.0.8.3.</span> <span class="toc-text">iii.查询文档-querystring查询</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3使用elasticsearch-head进行es客户端操作"><span class="toc-number">4.3.</span> <span class="toc-text">4.3使用elasticsearch-head进行es客户端操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-IK分词器和Elasticsearch集成使用"><span class="toc-number">5.</span> <span class="toc-text">5.IK分词器和Elasticsearch集成使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1IK分词器的安装"><span class="toc-number">5.1.</span> <span class="toc-text">5.1IK分词器的安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2IK分词器测试"><span class="toc-number">5.2.</span> <span class="toc-text">5.2IK分词器测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-ElasticSearch集群"><span class="toc-number">6.</span> <span class="toc-text">6.ElasticSearch集群</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-集群的搭建（Windows）"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 集群的搭建（Windows）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）准备三台elasticsearch服务器："><span class="toc-number">6.1.0.1.</span> <span class="toc-text">1）准备三台elasticsearch服务器：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2）修改每台服务器的配置"><span class="toc-number">6.1.0.2.</span> <span class="toc-text">2）修改每台服务器的配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-启动各个节点服务器"><span class="toc-number">6.1.0.3.</span> <span class="toc-text">3.启动各个节点服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-集群测试"><span class="toc-number">6.1.0.4.</span> <span class="toc-text">4.集群测试</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-ElasticSearch安装（Linux）"><span class="toc-number">7.</span> <span class="toc-text">7.ElasticSearch安装（Linux）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1）保证你已经安装了java环境"><span class="toc-number">7.0.0.1.</span> <span class="toc-text">1）保证你已经安装了java环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-修改配置文件"><span class="toc-number">7.0.0.2.</span> <span class="toc-text">2)修改配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3）启动"><span class="toc-number">7.0.0.3.</span> <span class="toc-text">3）启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-配置外网访问9200端口-需要开放服务器的端口"><span class="toc-number">7.0.0.4.</span> <span class="toc-text">4)配置外网访问9200端口  需要开放服务器的端口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-后台启动"><span class="toc-number">7.0.0.5.</span> <span class="toc-text">5)后台启动</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img%5Cmeinv1.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">林雨的小世界</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Elasticsearch入门篇</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-05-19 00:00:00"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-05-19</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-08-13 12:16:43"><i class="fas fa-history fa-fw"></i> 更新于 2020-08-13</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/ElasticSearch/">ElasticSearch</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>字数总计:</span><span class="word-count">5.9k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>阅读时长: 21 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="far fa-comments fa-fw post-meta__icon"></i><span>评论数:</span><a href="/2020/05/19/%E5%85%A8%E6%96%87%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/ElasticSearch%E5%85%A5%E9%97%A8/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/05/19/%E5%85%A8%E6%96%87%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/ElasticSearch%E5%85%A5%E9%97%A8/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>介绍ElasticSearch的作用，搭建elasticsearch的环境（Windows/Linux），对分词器的安装及使用；对es集群的搭建（Windows）下。本章介绍的ElasticSearch操作基于Restful形式，java代码操作请参考下篇：XXX</p>
<h1 id="1-ElasticSearch简介"><a href="#1-ElasticSearch简介" class="headerlink" title="1.ElasticSearch简介"></a>1.ElasticSearch简介</h1><blockquote>
<p>Elaticsearch，简称为es， es是一个开源的高扩展的分布式全文检索引擎，它可以近乎实时的存储、检索数据；本<br>身扩展性很好，可以扩展到上百台服务器，处理PB级别的数据。es也使用Java开发并使用Lucene作为其核心来实<br>现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得<br>简单。  </p>
</blockquote>
<h2 id="1-1ElasticSearch的使用案例"><a href="#1-1ElasticSearch的使用案例" class="headerlink" title="1.1ElasticSearch的使用案例"></a>1.1ElasticSearch的使用案例</h2><ul>
<li>2013年初，GitHub抛弃了Solr，采取ElasticSearch 来做PB级的搜索。 “GitHub使用ElasticSearch搜索20TB<br>的数据，包括13亿文件和1300亿行代码”</li>
<li>维基百科：启动以elasticsearch为基础的核心搜索架构</li>
<li>SoundCloud：“SoundCloud使用ElasticSearch为1.8亿用户提供即时而精准的音乐搜索服务”</li>
<li>百度：百度目前广泛使用ElasticSearch作为文本数据分析，采集百度所有服务器上的各类指标数据及用户自定义数据，通过对各种数据进行多维分析展示，辅助定位分析实例异常或业务层面异常。目前覆盖百度内部20多个业务线（包括casio、云分析、网盟、预测、文库、直达号、钱包、风控等），单集群最大100台机器，200个ES节点，每天导入30TB+数据</li>
<li>新浪使用ES 分析处理32亿条实时日志</li>
<li>阿里使用ES 构建挖财自己的日志采集和分析体系  </li>
</ul>
<h1 id="1-2-ElasticSearch与solr的对比"><a href="#1-2-ElasticSearch与solr的对比" class="headerlink" title="1.2 ElasticSearch与solr的对比"></a>1.2 ElasticSearch与solr的对比</h1><ul>
<li>Solr 利用 Zookeeper 进行分布式管理，而 Elasticsearch 自身带有分布式协调管理功能;</li>
<li>Solr 支持更多格式的数据，而 Elasticsearch 仅支持json文件格式；</li>
<li>Solr 官方提供的功能更多，而 Elasticsearch 本身更注重于核心功能，高级功能多有第三方插件提供；</li>
<li>Solr 在传统的搜索应用中表现好于 Elasticsearch，但在<strong>处理实时搜索应用时效率明显低于 Elasticsearch</strong>  </li>
</ul>
<p>2.ElasticSearch安装（windows）</p>
<p>下载压缩包：</p>
<p>ElasticSearch的官方地址： <a href="https://www.elastic.co/products/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/products/elasticsearch</a>  </p>
<h2 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1 安装"></a>2.1 安装</h2><p>注意：<strong>es使用java开发，使用lucene作为核心，需要配置好java环境！（jdk1.8以上）</strong></p>
<p>类似与tomcat，直接解压即可。其目录结构如下：</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150547117.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2NjM5MjMy,size_16,color_FFFFFF,t_70" alt="es01"></p>
<h2 id="2-2修改配置文件"><a href="#2-2修改配置文件" class="headerlink" title="2.2修改配置文件"></a>2.2修改配置文件</h2><ul>
<li>修改conf\jvm.option文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">将#-Xms2g                                  </span><br><span class="line">  #-Xmx2g修改成为：</span><br><span class="line">-Xms340m</span><br><span class="line">-Xmx340m</span><br><span class="line">否则因为虚拟机内存不够无法启动</span><br></pre></td></tr></table></figure>

<ul>
<li>修改conf\elasticsearch.yml文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch-<span class="number">5.6</span><span class="number">.8</span>\config\elasticsearch.yml中末尾加入：</span><br><span class="line">http.cors.enabled: <span class="keyword">true</span></span><br><span class="line">http.cors.allow-origin: <span class="string">"*"</span></span><br><span class="line">network.host: <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">目的是使ES支持跨域请求</span><br></pre></td></tr></table></figure>

<h2 id="2-3-启动"><a href="#2-3-启动" class="headerlink" title="2.3 启动"></a>2.3 启动</h2><p>点击ElasticSearch下的bin目录下的elasticsearch.bat启动，控制台显示的日志信息如下：  </p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150630195.png" alt="es02"></p>
<p><strong>注意：9300是tcp通信端口，es集群之间使用tcp进行通信，9200是http协议端口。</strong></p>
<p>我们在浏览器可以访问：</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150650820.png" alt="es03"></p>
<h2 id="2-4-安装图形化插件"><a href="#2-4-安装图形化插件" class="headerlink" title="2.4 安装图形化插件"></a>2.4 安装图形化插件</h2><blockquote>
<p>上述可以发现，ElasticSearch不同于Solr自带图形化界面，我们可以通过安装ElasticSearch的head插件，完成图形化界面的效果，完成索引数据的查看。安装插件的方式有两种，在线安装和本地安装。本文档采用本地安装方式进行head插件的安装。elasticsearch-5-*以上版本安装head需要安装node和grunt  。</p>
</blockquote>
<ul>
<li>下载head插件：<a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noopener">https://github.com/mobz/elasticsearch-head</a>  </li>
</ul>
<p>下载压缩包后解压即可。</p>
<ul>
<li>下载node.js：<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a>  </li>
</ul>
<p>双击安装，通过cmd输入 node -v查看版本号</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150702622.png" alt="es04"></p>
<ul>
<li>将grunt安装为全局命令 ，Grunt是基于Node.js的项目构建工具  </li>
</ul>
<p>在cmd中输入：</p>
<blockquote>
<p>npm install ‐g grunt‐cli  </p>
</blockquote>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150716993.png" alt="es05"></p>
<p><strong>由于访问的是国外的服务器，如果下载速度较慢，可以切换淘宝镜像</strong></p>
<blockquote>
<p>npm install -g cnpm –registry=<a href="https://registry.npm.taobao.org" target="_blank" rel="noopener">https://registry.npm.taobao.org</a></p>
<p>后续使用的时候，只需要把npm xxx  换成 cnpm xxx 即可</p>
</blockquote>
<p><strong>检测是否安装成功</strong></p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">npm</span> config get registry</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200619084941466.png" alt="es29"></p>
<p><font color='red'>注意：</font>后续使用时需要将<code>npm</code>替换为<code>cnpm</code>。</p>
<ul>
<li>启动head</li>
</ul>
<p>进入head插件目录，打开cmd，输入：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;npm install</span><br><span class="line">&gt;grunt server</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150729155.png" alt="es06"></p>
<p>打开浏览器，输入<a href="http://localhost:9100即可">http://localhost:9100即可</a></p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150743508.png" alt="es07"></p>
<h1 id="3-ES相关概念"><a href="#3-ES相关概念" class="headerlink" title="3.ES相关概念"></a>3.ES相关概念</h1><h2 id="3-1-概述（重要）"><a href="#3-1-概述（重要）" class="headerlink" title="3.1 概述（重要）"></a>3.1 概述（重要）</h2><p>Elasticsearch是面向文档(document oriented)的，这意味着它可以存储整个对象或文档(document)。然而它不仅<br>仅是存储，还会索引(index)每个文档的内容使之可以被搜索。在Elasticsearch中，你可以对文档（而非成行成列的数据）进行索引、搜索、排序、过滤。Elasticsearch比传统关系型数据库如下：  </p>
<blockquote>
<p>Relational DB ‐&gt; Databases ‐&gt; Tables ‐&gt; Rows ‐&gt; Columns<br>Elasticsearch ‐&gt; Indices ‐&gt; Types ‐&gt; Documents ‐&gt; Fields  </p>
</blockquote>
<h2 id="3-2-核心概念"><a href="#3-2-核心概念" class="headerlink" title="3.2 核心概念"></a>3.2 核心概念</h2><h4 id="1）index索引"><a href="#1）index索引" class="headerlink" title="1）index索引-"></a>1）index索引-</h4><blockquote>
<p>一个索引就是一个拥有几分相似特征的文档的集合。比如说，你可以有一个客户数据的索引，另一个产品目录的索引，还有一个订单数据的索引。一个索引由一个名字来标识（必须全部是小写字母的），并且当我们要对对应于这个索引中的文档进行索引、搜索、更新和删除的时候，都要使用到这个名字。在一个集群中，可以定义任意多的索引。<strong>可类比mysql中的数据库</strong></p>
</blockquote>
<h4 id="2）type类型"><a href="#2）type类型" class="headerlink" title="2）type类型"></a>2）type类型</h4><blockquote>
<p>在一个索引中，你可以定义一种或多种类型。一个类型是你的索引的一个逻辑上的分类/分区，其语义完全由你来定。通常，会为具有一组共同字段的文档定义一个类型。比如说，我们假设你运营一个博客平台并且将你所有的数据存储到一个索引中。在这个索引中，你可以为用户数据定义一个类型，为博客数据定义另一个类型，当然，也可以为评论数据定义另一个类型。  <strong>可类比mysql中的表</strong></p>
</blockquote>
<h4 id="3-Filed字段"><a href="#3-Filed字段" class="headerlink" title="3)Filed字段"></a>3)Filed字段</h4><blockquote>
<p>相当于是数据表的字段，对文档数据根据不同属性进行的分类标识  。</p>
</blockquote>
<h4 id="4）映射mapping"><a href="#4）映射mapping" class="headerlink" title="4）映射mapping"></a>4）映射mapping</h4><blockquote>
<p>mapping是处理数据的方式和规则方面做一些限制，如某个字段的数据类型、默认值、分析器、是否被索引等等，这些都是映射里面可以设置的，其它就是处理es里面数据的一些使用规则设置也叫做映射，按着最优规则处理数据对性能提高很大，因此才需要建立映射，并且需要思考如何建立映射才能对性能更好。<strong>相当于mysql中的创建表的过程，设置主键外键等等</strong></p>
</blockquote>
<h4 id="5）document文档"><a href="#5）document文档" class="headerlink" title="5）document文档"></a>5）document文档</h4><blockquote>
<p>一个文档是一个可被索引的基础信息单元。比如，你可以拥有某一个客户的文档，某一个产品的一个文档，当然，也可以拥有某个订单的一个文档。文档以JSON（Javascript Object Notation）格式来表示，而JSON是一个到处存在的互联网数据交互格式。在一个index/type里面，你可以存储任意多的文档。注意，尽管一个文档，物理上存在于一个索引之中，文档必须被索引/赋予一个索引的type。  <strong>插入索引库以文档为单位，类比与数据库中的一行数据</strong></p>
</blockquote>
<h4 id="6）集群cluster"><a href="#6）集群cluster" class="headerlink" title="6）集群cluster"></a>6）集群cluster</h4><blockquote>
<p>一个集群就是由一个或多个节点组织在一起，它们共同持有整个的数据，并一起提供索引和搜索功能。一个集群由 一个唯一的名字标识，这个名字默认就是“elasticsearch”。这个名字是重要的，因为一个节点只能通过指定某个集 群的名字，来加入这个集群。</p>
</blockquote>
<h4 id="7）节点node"><a href="#7）节点node" class="headerlink" title="7）节点node"></a>7）节点node</h4><blockquote>
<p>一个节点是集群中的一个服务器，作为集群的一部分，它存储数据，参与集群的索引和搜索功能。和集群类似，一 个节点也是由一个名字来标识的，默认情况下，这个名字是一个随机的漫威漫画角色的名字，这个名字会在启动的 时候赋予节点。这个名字对于管理工作来说挺重要的，因为在这个管理过程中，你会去确定网络中的哪些服务器对 应于Elasticsearch集群中的哪些节点。</p>
</blockquote>
<blockquote>
<p>一个节点可以通过配置集群名称的方式来加入一个指定的集群。默认情况下，每个节点都会被安排加入到一个叫 做“elasticsearch”的集群中，这意味着，如果你在你的网络中启动了若干个节点，并假定它们能够相互发现彼此， 它们将会自动地形成并加入到一个叫做“elasticsearch”的集群中。 </p>
</blockquote>
<blockquote>
<p>在一个集群里，只要你想，可以拥有任意多个节点。而且，如果当前你的网络中没有运行任何Elasticsearch节点， 这时启动一个节点，会默认创建并加入一个叫做“elasticsearch”的集群。</p>
</blockquote>
<h4 id="8）分片和复制-shards-amp-replicas"><a href="#8）分片和复制-shards-amp-replicas" class="headerlink" title="8）分片和复制 shards&amp;replicas"></a>8）分片和复制 shards&amp;replicas</h4><blockquote>
<p>一个索引可以存储超出单个结点硬件限制的大量数据。比如，一个具有10亿文档的索引占据1TB的磁盘空间，而任一节点都没有这样大的磁盘空间；或者单个节点处理搜索请求，响应太慢。为了解决这个问题，Elasticsearch提供了将索引划分成多份的能力，这些份就叫做分片。当你创建一个索引的时候，你可以指定你想要的分片的数量。每个分片本身也是一个功能完善并且独立的“索引”，这个“索引”可以被放置到集群中的任何节点上。分片很重要，主要有两方面的原因： 1）允许你水平分割/扩展你的内容容量。 2）允许你在分片（潜在地，位于多个节点上）之上进行分布式的、并行的操作，进而提高性能/吞吐量。</p>
</blockquote>
<blockquote>
<p>至于一个分片怎样分布，它的文档怎样聚合回搜索请求，是完全由Elasticsearch管理的，对于作为用户的你来说，这些都是透明的。</p>
</blockquote>
<blockquote>
<p>在一个网络/云的环境里，失败随时都可能发生，在某个分片/节点不知怎么的就处于离线状态，或者由于任何原因消失了，这种情况下，有一个故障转移机制是非常有用并且是强烈推荐的。为此目的，Elasticsearch允许你创建分片的一份或多份拷贝，这些拷贝叫做复制分片，或者直接叫复制。</p>
</blockquote>
<blockquote>
<p>复制之所以重要，有两个主要原因： 在分片/节点失败的情况下，提供了高可用性。因为这个原因，注意到复制分片从不与原/主要（original/primary）分片置于同一节点上是非常重要的。扩展你的搜索量/吞吐量，因为搜索可以在所有的复制上并行运行。总之，每个索引可以被分成多个分片。一个索引也可以被复制0次（意思是没有复制）或多次。一旦复制了，每个索引就有了主分片（作为复制源的原来的分片）和复制分片（主分片的拷贝）之别。分片和复制的数量可以在索引创建的时候指定。在索引创建之后，你可以在任何时候动态地改变复制的数量，但是你事后不能改变分片的数量。</p>
</blockquote>
<blockquote>
<p>默认情况下，Elasticsearch中的每个索引被分片5个主分片和1个复制，这意味着，如果你的集群中至少有两个节点，你的索引将会有5个主分片和另外5个复制分片（1个完全拷贝），这样的话每个索引总共就有10个分片。</p>
</blockquote>
<h1 id="4-ElasticSearch客户端操作"><a href="#4-ElasticSearch客户端操作" class="headerlink" title="4.ElasticSearch客户端操作"></a>4.ElasticSearch客户端操作</h1><p>上述部分为理论部分，实际开发中，主要有三种方式可以作为es服务的客户端：</p>
<ul>
<li>使用elasticsearch-head插件</li>
<li>使用elasticsearch提供的Restful接口直接访问</li>
<li>使用elasticsearch提供的API进行访问</li>
</ul>
<h2 id="4-1使用Restful接口直接访问"><a href="#4-1使用Restful接口直接访问" class="headerlink" title="4.1使用Restful接口直接访问"></a>4.1使用Restful接口直接访问</h2><p>我们需要使用http请求，介绍两款接口测试工具：postman和Talend API tester。</p>
<ul>
<li>Talend API tester安装：</li>
</ul>
<p>这是一款chrome插件，无需下载；</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150809520.png" alt="es08"></p>
<ul>
<li>Postman安装：</li>
</ul>
<p>Postman官网：<a href="https://www.getpostman.com" target="_blank" rel="noopener">https://www.getpostman.com</a>  </p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150821610.png" alt="es09"></p>
<h2 id="4-2使用Talend-API-tester进行es客户端操作。"><a href="#4-2使用Talend-API-tester进行es客户端操作。" class="headerlink" title="4.2使用Talend API tester进行es客户端操作。"></a>4.2使用Talend API tester进行es客户端操作。</h2><h4 id="1）Elasticsearch的接口语法"><a href="#1）Elasticsearch的接口语法" class="headerlink" title="1）Elasticsearch的接口语法"></a>1）Elasticsearch的接口语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl ‐X&lt;VERB&gt; &#39;&lt;PROTOCOL&gt;:&#x2F;&#x2F;&lt;HOST&gt;:&lt;PORT&gt;&#x2F;&lt;PATH&gt;?&lt;QUERY_STRING&gt;&#39; ‐d &#39;&lt;BODY&gt;&#39;</span><br></pre></td></tr></table></figure>

<p>其中：</p>
<p><img src= "/img/loading2.gif" data-src="../../../themes/Butterfly/source/img/imgs/ElasticSearch/es10.png" alt="image-20200519202141806"></p>
<h4 id="2）创建索引库index并添加映射mapping——PUT"><a href="#2）创建索引库index并添加映射mapping——PUT" class="headerlink" title="2）创建索引库index并添加映射mapping——PUT"></a>2）创建索引库index并添加映射mapping——PUT</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT</span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<blockquote>
<p>article：type类型；相当于这个索引库中有张表叫做article下面定义的这张表中的字段的定义，</p>
<p>字段默认为不索引的；</p>
<p>analyzer：分词器使用标准分词器</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"mappings"</span>: &#123;</span><br><span class="line">        <span class="attr">"article"</span>: &#123;</span><br><span class="line">            <span class="attr">"properties"</span>: &#123;</span><br><span class="line">                <span class="attr">"id"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"long"</span>,</span><br><span class="line">                    <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">"index"</span>: <span class="string">"not_analyzed"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"title"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">                    <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">"index"</span>: <span class="string">"analyzed"</span>,</span><br><span class="line">                    <span class="attr">"analyzer"</span>: <span class="string">"standard"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"content"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">                    <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">"index"</span>: <span class="string">"analyzed"</span>,</span><br><span class="line">                    <span class="attr">"analyzer"</span>: <span class="string">"standard"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150849412.png" alt="es11"></p>
<p>在可视化工具elasticsearch-head中查看：</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150900562.png" alt="es12"></p>
<h4 id="3）先创建索引index，再添加mapping-—-PUT"><a href="#3）先创建索引index，再添加mapping-—-PUT" class="headerlink" title="3）先创建索引index，再添加mapping —-PUT"></a>3）先创建索引index，再添加mapping —-PUT</h4><p>我们可以在创建索引时设置mapping信息，当然也可以先创建索引然后再设置mapping。<br>在上一个步骤中不设置maping信息，直接使用put方法创建一个索引，然后设置mapping信息。<br>请求的url：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT   http:<span class="comment">//127.0.0.1:9200/hello2/article/_mapping</span></span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="attr">"article"</span>: &#123;</span><br><span class="line">            <span class="attr">"properties"</span>: &#123;</span><br><span class="line">                <span class="attr">"id"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"long"</span>,</span><br><span class="line">                    <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">"index"</span>: <span class="string">"not_analyzed"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"title"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">                    <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">"index"</span>: <span class="string">"analyzed"</span>,</span><br><span class="line">                    <span class="attr">"analyzer"</span>: <span class="string">"standard"</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">"content"</span>: &#123;</span><br><span class="line">                    <span class="attr">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">                    <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">"index"</span>: <span class="string">"analyzed"</span>,</span><br><span class="line">                    <span class="attr">"analyzer"</span>: <span class="string">"standard"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150917469.png" alt="es13"></p>
<h4 id="4-删除索引index-—-DELETE"><a href="#4-删除索引index-—-DELETE" class="headerlink" title="4)删除索引index —-DELETE"></a>4)删除索引index —-DELETE</h4><p>请求URL:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE  http:<span class="comment">//127.0.0.1:9200/hello2</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/2020052015094023.png" alt="es14"></p>
<h4 id="5-创建文档document（向索引库中添加内容）—POST"><a href="#5-创建文档document（向索引库中添加内容）—POST" class="headerlink" title="5)创建文档document（向索引库中添加内容）—POST"></a>5)创建文档document（向索引库中添加内容）—POST</h4><p>请求URL:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST  http:<span class="comment">//127.0.0.1:9200/hello/article/1</span></span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">"title"</span>: <span class="string">"ElasticSearch是一个基于Lucene的搜索服务器"</span>,</span><br><span class="line">    <span class="attr">"content"</span>: <span class="string">"它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520150954677.png" alt="es15"></p>
<p>在elasticsearch-head中查看：</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151005515.png" alt="es16">))</p>
<p><strong>注意，一般我们将_id与id赋相同值。</strong></p>
<h4 id="6）修改document内容—-POST"><a href="#6）修改document内容—-POST" class="headerlink" title="6）修改document内容—-POST"></a>6）修改document内容—-POST</h4><p>请求URL:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http:<span class="comment">//127.0.0.1:9200/hello/article/1</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151016453.png" alt="es17"></p>
<p>在elasticsearch-head中查看：</p>
<p><img src= "/img/loading2.gif" data-src="../../../themes/Butterfly/source/img/imgs/ElasticSearch/es18.png" alt="image-20200519223532186"></p>
<h4 id="7-删除文档document—DELETE"><a href="#7-删除文档document—DELETE" class="headerlink" title="7)删除文档document—DELETE"></a>7)删除文档document—DELETE</h4><p>请求URL:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE http:<span class="comment">//127.0.0.1:9200/hello/article/2</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151039604.png" alt="es19"></p>
<h4 id="8-查询文档document—–GET"><a href="#8-查询文档document—–GET" class="headerlink" title="8)查询文档document—–GET"></a>8)查询文档document—–GET</h4><p>查询文档有三种方式：</p>
<ul>
<li>根据id查询；</li>
<li>根据关键词查询</li>
<li>根据输入的内容先分词，再查询</li>
</ul>
<h5 id="i-根据id查询"><a href="#i-根据id查询" class="headerlink" title="i.根据id查询"></a>i.根据id查询</h5><p>请求URL：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http:<span class="comment">//127.0.0.1:9200/hello/article/1</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151053919.png" alt="es20"></p>
<h5 id="ii-根据关键字查询-term查询"><a href="#ii-根据关键字查询-term查询" class="headerlink" title="ii.根据关键字查询-term查询"></a>ii.根据关键字查询-term查询</h5><p>请求URL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST http:&#x2F;&#x2F;127.0.0.1:9200&#x2F;hello&#x2F;article&#x2F;_search</span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"query"</span>: &#123;</span><br><span class="line">        <span class="attr">"term"</span>: &#123;</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"搜"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151109736.png" alt="es21"></p>
<h5 id="iii-查询文档-querystring查询"><a href="#iii-查询文档-querystring查询" class="headerlink" title="iii.查询文档-querystring查询"></a>iii.查询文档-querystring查询</h5><p>请求URL：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST   http:<span class="comment">//127.0.0.1:9200/hello/article/_search</span></span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"query"</span>: &#123;</span><br><span class="line">        <span class="string">"query_string"</span>: &#123;</span><br><span class="line">            <span class="string">"default_field"</span>: <span class="string">"title"</span>,</span><br><span class="line">            <span class="string">"query"</span>: <span class="string">"搜索服务器"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>指定：<br>       在哪个字段上进行查询；<br>        要查询的内容是什么；</p>
<p>它会把查询内容先进行分词，再进行查询</p>
</blockquote>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151130109.png" alt="es22"></p>
<h2 id="4-3使用elasticsearch-head进行es客户端操作"><a href="#4-3使用elasticsearch-head进行es客户端操作" class="headerlink" title="4.3使用elasticsearch-head进行es客户端操作"></a>4.3使用elasticsearch-head进行es客户端操作</h2><p>在elasticsearch-head中集成了http请求的工具，可以提供复查查询：</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151148628.png" alt="es27"></p>
<h1 id="5-IK分词器和Elasticsearch集成使用"><a href="#5-IK分词器和Elasticsearch集成使用" class="headerlink" title="5.IK分词器和Elasticsearch集成使用"></a>5.IK分词器和Elasticsearch集成使用</h1><p>上述分词器使用的是标准分词器，其对中文分词不是很友好，例如对我是程序员进行分词得到：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET http:<span class="comment">//127.0.0.1:9200/_analyze?analyzer=standard&amp;pretty=true&amp;text=我是程序员</span></span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">"tokens":[</span><br><span class="line">&#123;"token": "我", "start_offset": 0, "end_offset": 1, "type": "&lt;IDEOGRAPHIC&gt;",…&#125;,</span><br><span class="line">&#123;"token": "是", "start_offset": 1, "end_offset": 2, "type": "&lt;IDEOGRAPHIC&gt;",…&#125;,</span><br><span class="line">&#123;"token": "程", "start_offset": 2, "end_offset": 3, "type": "&lt;IDEOGRAPHIC&gt;",…&#125;,</span><br><span class="line">&#123;"token": "序", "start_offset": 3, "end_offset": 4, "type": "&lt;IDEOGRAPHIC&gt;",…&#125;,</span><br><span class="line">&#123;"token": "员", "start_offset": 4, "end_offset": 5, "type": "&lt;IDEOGRAPHIC&gt;",…&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>我们希望达到的分词是：我、是、程序、程序员。</p>
<p>支持中文的分词器有很多，word分词器，庖丁解牛，Ansj分词器，下面注意说IK分词器的使用。</p>
<h2 id="5-1IK分词器的安装"><a href="#5-1IK分词器的安装" class="headerlink" title="5.1IK分词器的安装"></a>5.1IK分词器的安装</h2><p>1）下载地址：<a href="https://github.com/medcl/elasticsearch-analysis-ik/releases" target="_blank" rel="noopener">https://github.com/medcl/elasticsearch-analysis-ik/releases</a>  </p>
<p>2）解压，将解压后的elasticsearch文件夹拷贝到elasticsearch-5.6.8\plugins下，并重命名文件夹为analysis-ik  （其他名字也可以，目的是不要重名）</p>
<p>3）重新启动ElasticSearch，即可加载IK分词器  </p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151205757.png" alt="es23">))</p>
<h2 id="5-2IK分词器测试"><a href="#5-2IK分词器测试" class="headerlink" title="5.2IK分词器测试"></a>5.2IK分词器测试</h2><p>IK提供两种分词ik_smart和ik_max_word</p>
<p>其中ik_smart为最少切分，ik_max_word为最细粒度划分。</p>
<p>下面测试一下：</p>
<ul>
<li>最小切分：在浏览器输入地址：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET   http:<span class="comment">//127.0.0.1:9200/_analyze?analyzer=ik_smart&amp;pretty=true&amp;text=我是程序员</span></span><br></pre></td></tr></table></figure>

<p>返回结果：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"tokens":[</span><br><span class="line">&#123;"token": "我", "start_offset": 0, "end_offset": 1, "type": "CN_CHAR",…&#125;,</span><br><span class="line">&#123;"token": "是", "start_offset": 1, "end_offset": 2, "type": "CN_CHAR",…&#125;,</span><br><span class="line">&#123;"token": "程序员", "start_offset": 2, "end_offset": 5, "type": "CN_WORD",…&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<ul>
<li>最新切分：在浏览器输入地址：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET   http:<span class="comment">//127.0.0.1:9200/_analyze?analyzer=ik_max_word&amp;pretty=true&amp;text=我是程序员</span></span><br></pre></td></tr></table></figure>

<p>返回结果：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">"tokens":[</span><br><span class="line">&#123;"token": "我", "start_offset": 0, "end_offset": 1, "type": "CN_CHAR",…&#125;,</span><br><span class="line">&#123;"token": "是", "start_offset": 1, "end_offset": 2, "type": "CN_CHAR",…&#125;,</span><br><span class="line">&#123;"token": "程序员", "start_offset": 2, "end_offset": 5, "type": "CN_WORD",…&#125;,</span><br><span class="line">&#123;"token": "程序", "start_offset": 2, "end_offset": 4, "type": "CN_WORD",…&#125;,</span><br><span class="line">&#123;"token": "员", "start_offset": 4, "end_offset": 5, "type": "CN_CHAR",…&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h1 id="6-ElasticSearch集群"><a href="#6-ElasticSearch集群" class="headerlink" title="6.ElasticSearch集群"></a>6.ElasticSearch集群</h1><blockquote>
<p>ES集群是一个 P2P类型(使用 gossip 协议)的分布式系统，除了集群状态管理以外，其他所有的请求都可以发送到集群内任意一台节点上，这个节点可以自己找到需要转发给哪些节点，并且直接跟这些节点通信。所以，从网络架构及服务配置上来说，构建集群所需要的配置极其简单。在 Elasticsearch 2.0 之前，无阻碍的网络下，所有配置了相同 cluster.name 的节点都自动归属到一个集群中。2.0 版本之后，基于安全的考虑避免开发环境过于随便造成的麻烦，从 2.0 版本开始，默认的自动发现方式改为了单播(unicast)方式。配置里提供几台节点的地址，ES 将其视作gossip router 角色，借以完成集群的发现。由于这只是 ES 内一个很小的功能，所以 gossip router 角色并不需要单独配置，每个 ES 节点都可以担任。所以，采用单播方式的集群，各节点都配置相同的几个节点列表作为 router即可。  </p>
</blockquote>
<p>集群中节点数量没有限制，一般大于等于2个节点就可以看做是集群了。一般处于高性能及高可用方面来</p>
<p>虑一般集群中的节点数量都是3个及3个以上  .</p>
<h2 id="6-1-集群的搭建（Windows）"><a href="#6-1-集群的搭建（Windows）" class="headerlink" title="6.1 集群的搭建（Windows）"></a>6.1 集群的搭建（Windows）</h2><h4 id="1）准备三台elasticsearch服务器："><a href="#1）准备三台elasticsearch服务器：" class="headerlink" title="1）准备三台elasticsearch服务器："></a>1）准备三台elasticsearch服务器：</h4><p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151219770.png" alt="es24"></p>
<h4 id="2）修改每台服务器的配置"><a href="#2）修改每台服务器的配置" class="headerlink" title="2）修改每台服务器的配置"></a>2）修改每台服务器的配置</h4><p>修改\comf\elasticsearch.yml配置文件：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#Node节点1：</span><br><span class="line"></span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: "*"</span><br><span class="line">#节点1的配置信息：</span><br><span class="line">#集群名称，保证唯一</span><br><span class="line">cluster.name: my-elasticsearch</span><br><span class="line">#节点名称，必须不一样</span><br><span class="line">node.name: node-1</span><br><span class="line">#必须为本机的ip地址</span><br><span class="line">network.host: 127.0.0.1</span><br><span class="line">#服务端口号，在同一机器下必须不一样</span><br><span class="line">http.port: 9201</span><br><span class="line">#集群间通信端口号，在同一机器下必须不一样</span><br><span class="line">transport.tcp.port: 9301</span><br><span class="line">#设置集群自动发现机器ip集合</span><br><span class="line">discovery.zen.ping.unicast.hosts: ["127.0.0.1:9301","127.0.0.1:9302","127.0.0.1:9303"]</span><br><span class="line"></span><br><span class="line">#Node节点2：</span><br><span class="line"></span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: "*"</span><br><span class="line">#节点1的配置信息：</span><br><span class="line">#集群名称，保证唯一</span><br><span class="line">cluster.name: my-elasticsearch</span><br><span class="line">#节点名称，必须不一样</span><br><span class="line">node.name: node-2</span><br><span class="line">#必须为本机的ip地址</span><br><span class="line">network.host: 127.0.0.1</span><br><span class="line">#服务端口号，在同一机器下必须不一样</span><br><span class="line">http.port: 9202</span><br><span class="line">#集群间通信端口号，在同一机器下必须不一样</span><br><span class="line">transport.tcp.port: 9302</span><br><span class="line">#设置集群自动发现机器ip集合</span><br><span class="line">discovery.zen.ping.unicast.hosts: ["127.0.0.1:9301","127.0.0.1:9302","127.0.0.1:9303"]</span><br><span class="line"></span><br><span class="line">#Node节点3：</span><br><span class="line"></span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: "*"</span><br><span class="line">#节点1的配置信息：</span><br><span class="line">#集群名称，保证唯一</span><br><span class="line">cluster.name: my-elasticsearch</span><br><span class="line">#节点名称，必须不一样</span><br><span class="line">node.name: node-3</span><br><span class="line">#必须为本机的ip地址</span><br><span class="line">network.host: 127.0.0.1</span><br><span class="line">#服务端口号，在同一机器下必须不一样</span><br><span class="line">http.port: 9203</span><br><span class="line">#集群间通信端口号，在同一机器下必须不一样</span><br><span class="line">transport.tcp.port: 9303</span><br><span class="line">#设置集群自动发现机器ip集合</span><br><span class="line">discovery.zen.ping.unicast.hosts: ["127.0.0.1:9301","127.0.0.1:9302","127.0.0.1:9303"]</span><br></pre></td></tr></table></figure>

<h4 id="3-启动各个节点服务器"><a href="#3-启动各个节点服务器" class="headerlink" title="3.启动各个节点服务器"></a>3.启动各个节点服务器</h4><p>可以分别启动每个服务器下的elasticsearch.bat，我这里使用的是windows下的批处理文件：</p>
<p>新建一个elasticsearch_cluster_start.bat文件，然后添加下面内容：</p>
<p>格式为：start  “需要启动的文件名”   “文件的路径”  &amp;表示启动A后继续执行。</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> "elasticsearch.bat" "F:\Soft\ES-cluster\cluster01\bin\elasticsearch.bat" &amp;</span><br><span class="line"><span class="built_in">start</span> "elasticsearch.bat" "F:\Soft\ES-cluster\cluster02\bin\elasticsearch.bat" &amp;</span><br><span class="line"><span class="built_in">start</span> "elasticsearch.bat" "F:\Soft\ES-cluster\cluster03\bin\elasticsearch.bat"</span><br></pre></td></tr></table></figure>

<p>关于Windows的批处理在本章就不细说了。</p>
<h4 id="4-集群测试"><a href="#4-集群测试" class="headerlink" title="4.集群测试"></a>4.集群测试</h4><blockquote>
<p>只要连接集群中的任意节点，其操作方式与单机版本基本相同，改变的仅仅是存储的结构。</p>
</blockquote>
<p><strong>添加索引和映射</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT  http:<span class="comment">//127.0.0.1:9201/hello</span></span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"mappings"</span>: &#123;</span><br><span class="line">    <span class="attr">"article"</span>: &#123;</span><br><span class="line">        <span class="attr">"properties"</span>: &#123;</span><br><span class="line">            <span class="attr">"id"</span>: &#123;</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"long"</span>,</span><br><span class="line">                <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                 <span class="attr">"index"</span>: <span class="string">"not_analyzed"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"title"</span>: &#123;</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">                <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"index"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"analyzer"</span>: <span class="string">"ik_smart"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">"content"</span>: &#123;</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">                <span class="attr">"store"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"index"</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">"analyzer"</span>: <span class="string">"ik_smart"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回结果：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"acknowledged"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">"shards_acknowledged"</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">"index"</span>: <span class="string">"hello"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>添加文档</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST   http:<span class="comment">//127.0.0.1:9201/hello/article/1</span></span><br></pre></td></tr></table></figure>

<p>请求体：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"id"</span>:<span class="number">1</span>,</span><br><span class="line"><span class="attr">"title"</span>:<span class="string">"ElasticSearch是一个基于Lucene的搜索服务器"</span>,</span><br><span class="line"><span class="attr">"content"</span>:<span class="string">"它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回值：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"_index"</span>: <span class="string">"hello"</span>,</span><br><span class="line"><span class="attr">"_type"</span>: <span class="string">"article"</span>,</span><br><span class="line"><span class="attr">"_id"</span>: <span class="string">"1"</span>,</span><br><span class="line"><span class="attr">"_version"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"result"</span>: <span class="string">"created"</span>,</span><br><span class="line"><span class="attr">"_shards"</span>:&#123;</span><br><span class="line"><span class="attr">"total"</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">"successful"</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">"failed"</span>: <span class="number">0</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">"created"</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在elasticsearch-head中查看：</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151239347.png" alt="es25">))</p>
<p><img src= "/img/loading2.gif" data-src="https://img-blog.csdnimg.cn/20200520151250420.png" alt="es26"></p>
<h1 id="7-ElasticSearch安装（Linux）"><a href="#7-ElasticSearch安装（Linux）" class="headerlink" title="7.ElasticSearch安装（Linux）"></a>7.ElasticSearch安装（Linux）</h1><h4 id="1）保证你已经安装了java环境"><a href="#1）保证你已经安装了java环境" class="headerlink" title="1）保证你已经安装了java环境"></a>1）保证你已经安装了java环境</h4><p>可以直接把windows中的copy过去，不用安装，解压即可。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxf elasticsearch-6.3.2.tar.gz</span><br></pre></td></tr></table></figure>

<h4 id="2-修改配置文件"><a href="#2-修改配置文件" class="headerlink" title="2)修改配置文件"></a>2)修改配置文件</h4><ul>
<li>修改conf\jvm.option文件</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">将#-Xms2g                                  </span><br><span class="line">  #-Xmx2g修改成为：</span><br><span class="line">-Xms340m</span><br><span class="line">-Xmx340m</span><br><span class="line">否则因为虚拟机内存不够无法启动</span><br></pre></td></tr></table></figure>

<ul>
<li>修改conf\elasticsearch.yml文件</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#elasticsearch-5.6.8\config\elasticsearch.yml中末尾加入：</span><br><span class="line">http.cors.enabled: true</span><br><span class="line">http.cors.allow-origin: "*"</span><br><span class="line">network.host: 127.0.0.1</span><br><span class="line">目的是使ES支持跨域请求</span><br></pre></td></tr></table></figure>

<h4 id="3）启动"><a href="#3）启动" class="headerlink" title="3）启动"></a>3）启动</h4><p><strong>注意：在linux环境下不支持root用户直接启动（理由是安全问题）</strong></p>
<ul>
<li>添加用户：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@coderxz bin]# useradd rxz -p rongxianzhao</span><br><span class="line">[root@coderxz bin]# chown -R rxz:rxz /usr/local/elasticsearch/*</span><br><span class="line">[root@coderxz bin]# su rxz</span><br></pre></td></tr></table></figure>

<ul>
<li>执行：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">注意：切换为非root用户执行哦</span></span><br><span class="line">[rxz@coderxz bin]$ ./elasticsearch</span><br></pre></td></tr></table></figure>

<ul>
<li>查看运行状态：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">检测是否运行：jps （显示所有的Java进程pid的命令）</span><br><span class="line">	              ps aux|grep elasticsearch</span><br><span class="line">				  [root@coderxz ~]# curl -X GET 'http://localhost:9200'</span><br></pre></td></tr></table></figure>

<h4 id="4-配置外网访问9200端口-需要开放服务器的端口"><a href="#4-配置外网访问9200端口-需要开放服务器的端口" class="headerlink" title="4)配置外网访问9200端口  需要开放服务器的端口"></a>4)配置外网访问9200端口  需要开放服务器的端口</h4><blockquote>
<p>修改配置文件 config/elasticsearch.yml</p>
<p>network.host: 0.0.0.0</p>
</blockquote>
<h4 id="5-后台启动"><a href="#5-后台启动" class="headerlink" title="5)后台启动"></a>5)后台启动</h4><blockquote>
<p>如果你在服务器上安装Elasticsearch，而你想在本地机器上进行开发，这时候，你很可能需要在关闭终端的时候，让Elasticsearch继续保持运行。最简单的方法就是使用nohup。先按<strong>Ctrl + C</strong>，停止当前运行的Elasticsearch，改用下面的命令运行Elasticsearch。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup ./bin/elasticsearch&amp;</span><br></pre></td></tr></table></figure>



</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">小雨</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.codelyc.top/2020/05/19/%E5%85%A8%E6%96%87%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/ElasticSearch%E5%85%A5%E9%97%A8/">http://www.codelyc.top/2020/05/19/%E5%85%A8%E6%96%87%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/ElasticSearch%E5%85%A5%E9%97%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.codelyc.top" target="_blank">林雨的小世界</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java/">java</a><a class="post-meta__tags" href="/tags/%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2%E6%9C%8D%E5%8A%A1%E5%99%A8/">全文检索服务器</a></div><div class="post_share"><div class="social-share" data-image="https://img-blog.csdnimg.cn/20201016152944258.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.png" alt="微信" onclick="window.open('/img/wechat.png')"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.jpg" alt="支付宝" onclick="window.open('/img/alipay.jpg')"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2020/07/07/linux%E5%B7%A5%E5%85%B7/linux%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><img class="prev-cover" data-src="https://img-blog.csdnimg.cn/20200707233252747.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CentOS7系统安装</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'Qo9gxgBRvQJMD2Xo20vLz5kd-gzGzoHsz',
  appKey: 'zeSCFdCx0eahKdGYpLyJ1LRr',
  placeholder: '记得留下你的暱称和邮箱....可以快速收到回復',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: {"tv_0":"https://raw.githubusercontent.com/blogimg/emotion/master/qq_2020f/0.gif","tv_1":"https://raw.githubusercontent.com/blogimg/emotion/master/qq_2020f/1.gif","tv_2":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/2.gif","tv_3":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/3.gif","tv_4":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/4.gif","tv_5":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/5.gif","tv_6":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/6.gif","tv_7":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/7.gif","tv_8":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/8.gif","tv_9":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/9.gif","tv_10":"https://raw.githubusercontent.com/blogimg/emotion/master/qq_2020f/10.gif","tv_11":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/11.gif","tv_12":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/12.gif","tv_13":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/13.gif","tv_14":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/14.gif","tv_15":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/15.gif","tv_16":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/16.gif","tv_17":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/17.gif","tv_18":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/18.gif","tv_19":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/19.gif","tv_20":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/20.gif","tv_21":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/21.gif","tv_22":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/22.gif","tv_23":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/23.gif","tv_24":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/24.gif","tv_25":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/25.gif","tv_26":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/26.gif","tv_27":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/27.gif","tv_28":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/28.gif","tv_29":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/29.gif","tv_30":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/30.gif","tv_31":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/31.gif","tv_32":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/32.gif","tv_33":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/33.gif","tv_34":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/34.gif","tv_35":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/35.gif","tv_36":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/36.gif","tv_37":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/37.gif","tv_38":"https://raw.githubusercontent.com/codelyc/emotion/master/qq_2020f/38.gif","wb_1":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/aini.png","wb_2":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/aoteman.png","wb_3":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/baibai.png","wb_4":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/beishang.png","wb_5":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/bishi.png","wb_6":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/bizui.png","wb_7":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/chanzui.png","wb_8":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/chijing.png","wb_9":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dahaqi.png","wb_10":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dalian.png","wb_11":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/ding.png","wb_12":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog1.png","wb_13":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog10.png","wb_14":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog11.png","wb_15":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog12.png","wb_16":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog13.png","wb_17":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog2.png","wb_18":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog3.png","wb_19":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog4.png","wb_20":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog5.png","wb_21":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog6.png","wb_22":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog7.png","wb_23":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog8.png","wb_24":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog9.png","wb_25":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog14.png","wb_26":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/dog15.png","wb_27":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/doge.png","wb_28":"https://raw.githubusercontent.com/codelyc/emotion/master/weibo/erha.png"},
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 小雨</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">繁</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fas fa-comments"></i></a><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script></body></html>